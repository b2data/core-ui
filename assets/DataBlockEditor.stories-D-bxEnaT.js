import{r as k,j as r}from"./iframe-BjsjcTCH.js";import{D as B,H as S}from"./DropZone-CrUnGi_i.js";import{p as N,a as u,W as I,b as E,u as l}from"./DataBlock-DiZEvLtI.js";import{c as x,H as h,T as L,d as s}from"./ListNumberedIcon-FNAwzL11.js";import{L as P}from"./ListItem-yudmKKA9.js";import{P as C}from"./Popper-B-wSHak9.js";import"./preload-helper-D9Z9MdNV.js";import"./Typography-CsaR6tVH.js";import"./Typography-B8xzsPaS.js";import"./memoTheme-BkiB6XT-.js";import"./styled-B_VYI8z9.js";import"./createSimplePaletteValueFilter-bm0fmN_7.js";import"./generateUtilityClasses-DDbjFgb8.js";import"./generateUtilityClass-BtcU_pBl.js";import"./Box-DHB9hgUt.js";import"./index-BZR1GnOa.js";import"./v4-BKrj-4V8.js";import"./Alert-CVgrl3l4.js";import"./useSlot-_7UiI0BH.js";import"./mergeSlotProps-Bba1iLBA.js";import"./isHostComponent-DVu5iVWx.js";import"./useForkRef-CFOv3ZhY.js";import"./createSvgIcon-BWDMKnaQ.js";import"./Close-DvCmWYxP.js";import"./IconButton-CzfJHRHW.js";import"./ButtonBase-CkJtUOr4.js";import"./useTimeout-CGfVXgdi.js";import"./TransitionGroupContext-DktGN6vV.js";import"./useEventCallback-Cx1VukeI.js";import"./isFocusVisible-B8k4qzLc.js";import"./CircularProgress-D0bWzO0z.js";import"./Paper-CztJE2D3.js";import"./useTheme-Bdxx-ZzA.js";import"./Autocomplete-CRCASpz2.js";import"./Paper-DAY6tLhN.js";import"./TextField-DXJ3l7BH.js";import"./TextField-B0qT-cvg.js";import"./useFormControl-DV89jgTs.js";import"./formControlState-Dq1zat_P.js";import"./InputBase-CPiPdEi_.js";import"./ownerWindow-HkKU3E4x.js";import"./ownerDocument-DW-IO8s5.js";import"./debounce-Be36O1Ab.js";import"./FormHelperText-DpvVwx05.js";import"./Menu-w4TTDU8h.js";import"./useSlotProps-B8t0lEUz.js";import"./Popover-DdIWv69b.js";import"./Grow-B45jD6oF.js";import"./utils-C829QIR_.js";import"./index-B6TwdEj4.js";import"./index-SVAzG-T_.js";import"./getReactElementRef-BzEn9AjC.js";import"./mergeSlotProps-Dw6Vk27m.js";import"./Modal-BlMYs-AT.js";import"./getScrollbarSize-CaCM53D3.js";import"./createChainedFunction-BO_9K8Jh.js";import"./Portal-_D9UOzoy.js";import"./Backdrop-B0Qd6KlM.js";import"./MenuList-Du58ZBpe.js";import"./ListContext-Y-dn3Bui.js";import"./useControlled-U77RKmuN.js";import"./isMuiElement-DqggRh2f.js";import"./CircularProgress-C0zgGV6I.js";import"./Popper-BVnajaSs.js";import"./Chip-Dh_o-OzT.js";import"./ListSubheader-CCQRp570.js";import"./Avatar-DR_cFGBx.js";import"./AvatarGroup-CTPCd4hY.js";import"./Backdrop-rTuc6Fu3.js";import"./index-BJhsDPk3.js";import"./EventManager-BfTL-EYO.js";import"./index-BqUcDmpy.js";import"./KeyboardArrowRight-DoBAB0im.js";import"./MenuItem-Ds4qH_mg.js";import"./listItemTextClasses-CiRxluPw.js";import"./styled-CfreJIUB.js";import"./Switch-BLbgNDaI.js";import"./SwitchBase-B4Ost8d5.js";import"./Skeleton-BcBMH9N7.js";import"./Tooltip-CySb7oCo.js";import"./Button-brVShAc1.js";import"./LinearProgress-CS0V-vd-.js";import"./FormControlLabel-DmVytqwU.js";import"./ListItemText-Df__InLT.js";import"./Checkbox-Dk45w6Zy.js";import"./ClickAwayListener-Gbp8DirE.js";import"./getThemeProps-FiYinGev.js";import"./Button-fupQ1Nhc.js";import"./Link-B3NNSWfP.js";import"./Checkbox-Y_pu-q3f.js";import"./Divider-DUsGD5rM.js";import"./ClickAwayListener-BJMLKnrp.js";import"./Collapse-CUP8s1T5.js";import"./Collapse-DoHhn7Rv.js";import"./ConfirmationDialog-fILA6v6S.js";import"./Dialog-o0bHGwIv.js";import"./DialogActions-B9nDXdS0.js";import"./DialogActions-ChreXdJJ.js";import"./DialogContent-C68lD9Cy.js";import"./DialogContent-BQa8PvFR.js";import"./dialogTitleClasses-Df1yqyCK.js";import"./DialogTitle-DeJpkof4.js";import"./DialogContext-7Fzgb-zY.js";import"./Dialog-0HkUIWtj.js";import"./IconButton-5vGrSHtF.js";import"./Popover-CUTJyg0j.js";import"./DatePicker-CqA02kX-.js";import"./useThemeProps-5orkHAQK.js";import"./useThemeProps-DionEAg3.js";import"./visuallyHidden-Dan1xhjv.js";import"./ListItem-n8qqApYV.js";import"./listItemButtonClasses-CXNhffuE.js";import"./Tab-CFwJb9Td.js";import"./FormHelperText-B6A-eWRO.js";import"./DateTimePicker-C5MC3Pkl.js";import"./Drawer-D5JPBFtS.js";import"./FormControlLabel-CFFvZlfq.js";import"./InputBase-4xenKZEt.js";import"./LinearProgress-BM-8Dvj5.js";import"./ListItemAvatar-NlkvTGwY.js";import"./ListItemButton-4ofyjYO-.js";import"./MarkdownContent-B5qCQNs-.js";import"./MarkdownField-DAEDny9r.js";import"./Menu-BTFUtlxw.js";import"./MenuItem-CP34sf5D.js";import"./MenuList-CefKjPNe.js";import"./Portal-DaBRkYns.js";import"./ProgressStatistic-BeUZ47ns.js";import"./Radio-DgEAXQgp.js";import"./RadioGroup-Bef51d4U.js";import"./Skeleton-nWOoDhqP.js";import"./SkeletonGroup-D_XADdBd.js";import"./Slider-Bd6AR87V.js";import"./SnackbarProvider-F5wxQ-kP.js";import"./SnackbarMessage-CXCU2hBS.js";import"./Stepper-55UMw04m.js";import"./Switch-DWWwYMk2.js";import"./Tab-CAgMBuL0.js";import"./TimePicker-BDb1mId9.js";const ln={title:"Components/Data Block/Data Block Editor",component:x,tags:["autodocs"]},c={id:"user1",avatar:"",firstName:"Demo ",lastName:"user",middleName:""},T=Array.from(new Array(10)).map(()=>({id:l(),type:"text",offset:0,hidePrefix:!1,variants:[{id:l(),data:{text:"Hello, World!"},isCurrent:!0,votes:[],createdBy:"user1",createdByData:c},{id:l(),data:{text:"Hello, World!"},isCurrent:!1,votes:[],createdBy:"user2",createdByData:{id:"user2",avatar:"",firstName:"Maria",lastName:"",middleName:""}}]})),f={args:{editable:!0,currentUser:c,tools:{},blocks:[{id:"0",type:"text",offset:0,hidePrefix:!1,variants:[{id:"11",data:{text:"Some text is here and link to image ![[ChatGPT Image.png#1|56f2fb22-2ed7-4d77-b4fa-8fab55c90d93#6cac5fb7-5416-4749-9ada-0c4920aa01df|700]] And video ![[test video.mov#1|486503f6-35e9-4865-970f-a211ec242527#0fd10b4d-cebe-4bbd-81da-64d8c1b222a5]] And PDF: ![[app.pdf#1|486503f6-35e9-4865-970f-a211ec242527#0fd10b4d-cebe-4bbd-81da-64d8c1b222a5]]"},isCurrent:!0,votes:[],createdBy:"user1",createdByData:{id:"user1",avatar:"",firstName:"John 1",lastName:"",middleName:""}}]},{id:"1",type:"text",offset:0,hidePrefix:!1,variants:[{id:"11",data:{text:`> [!sign]
> 1. @User 1#Space 1|0:1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef#a41b8b6c-c75f-4ee3-9c19-1d41dc157f96
> 2. @User 2#Space 1|-1:1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef#12979c75-d5b9-4759-9060-b7a41dc76ea8`},isCurrent:!0,votes:[],createdBy:"user1",createdByData:{id:"user1",avatar:"",firstName:"John 1",lastName:"",middleName:""}},{id:"12",data:{text:"Hello, World!"},isCurrent:!1,votes:[],createdBy:"user2",createdByData:{id:"user2",avatar:"",firstName:"Maria",lastName:"",middleName:""}}]},{id:"2",type:"header",offset:0,hidePrefix:!1,variants:[{id:"22",data:{text:"```js \nconst a = 1;\n```"},isCurrent:!0,votes:[],createdBy:"user1",createdByData:{id:"user1",avatar:"",firstName:"John 1",lastName:"",middleName:""}}]},{id:"3",type:"text",offset:0,hidePrefix:!1,variants:[{id:"22",data:{text:`[Duck Duck Go](https://duckduckgo.com "The best search engine for privacy") Strange idea! @nice|shot|good@. Really?

@nice|123|https://market.b2p.space/api/files/8646013d-5a03-4a9a-a0eb-da774adc0b95@

@nice|123|@

@nice@ test me

[[Правила кооператива_v2_п.2.1|123_345_566]]`},isCurrent:!0,votes:[],createdBy:"user1",createdByData:{id:"user1",avatar:"",firstName:"John 1",lastName:"",middleName:""}}]},{id:"4",type:"heading",offset:0,hidePrefix:!1,variants:[{id:"22",data:{text:"## Heading 2",level:2},isCurrent:!0,votes:[],createdBy:"user3",createdByData:{id:"user3",avatar:"",firstName:"John",lastName:"",middleName:""}}]},{id:"5",type:"text",offset:0,hidePrefix:!1,variants:[{id:"22",data:{text:"Monday **10**. ==Nice shot and the **shot** is good!== How are you? Nice ==day"},isCurrent:!0,votes:[],createdBy:"user1",createdByData:{id:"user3",avatar:"",firstName:"John",lastName:"",middleName:""}}]},...T]},render:g=>{const o=k.useRef(null),[v,D]=k.useState(null),y=({action:e,data:t})=>{setTimeout(()=>{switch(e){case s.AddBlock:o.current?.updateData({action:e,data:{index:t.index,blocks:t.blocks.map(n=>({...n,variants:n.variants.map(i=>({...i,createdByData:c,votes:[]}))}))}});break;case s.EditBlock:o.current?.updateData({action:e,data:{block:{...t.block,variants:t.variant?[{...t.variant,createdByData:c,votes:[]}]:[]},variant:{...t.variant,createdByData:c,votes:[]}}});break;case s.DeleteBlock:o.current?.updateData({action:e,data:{blockId:t.blockId}});break;case s.MoveBlock:o.current?.updateData({action:e,data:{blockId:t.blockId,targetIndex:t.targetIndex}});break;case s.AddVariant:o.current?.updateData({action:e,data:{blockId:t.blockId,variant:{...t.variant,createdByData:c,votes:[]}}});break;case s.EditVariant:o.current?.updateData({action:e,data:{blockId:t.blockId,variant:{...t.variant,createdByData:c,votes:[]}}});break;case s.DeleteVariant:o.current?.updateData({action:e,data:{blockId:t.blockId,variantId:t.variantId}});break}},1e3)};return r.jsx("div",{style:{background:"#f9f9f9",margin:"-40px -30px",padding:"40px 30px",height:500,overflowY:"auto"},children:r.jsx(B,{backend:S,children:r.jsx(x,{...g,ref:o,onChange:y,tools:{text:{title:"Text",icon:L,shortcut:["CMD"]},heading:{title:"Header",defaultValue:"# ",icon:h,renderMenu:({variant:e})=>r.jsxs(r.Fragment,{children:[r.jsx(P,{asButton:!0,icon:r.jsx(h,{}),onClick:t=>D(t.currentTarget),text:r.jsxs(r.Fragment,{children:["Header ",e.data.text.split(" ")[0].length]})}),r.jsx(C,{open:!!v,anchorEl:v,children:"TODO SELECT HEADER LEVEL"})]})},sign:{title:"Signature",icon:h,defaultValue:`> [!sign]
> 1. `,renderMenu:()=>r.jsx(r.Fragment,{children:"TODO"})}},mdProps:{onSearchMentions:async({query:e=""})=>new Promise(t=>{setTimeout(()=>{t([{name:"User 1",detailId:l(),detailLabel:"Space 1",id:"0:1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef"},{name:"User 2",detailId:l(),detailLabel:"Space 1",id:"-1:1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef"}].filter(n=>e?n.name.indexOf(e)>-1:!0))},1e3)}),resolveReferenceUrl:({versionId:e})=>e?`https://localhost:8080/documents/files/${e}`:"",onSearchReference:async({query:e=""})=>new Promise(t=>{setTimeout(()=>{t([{label:"ChatGPT Image.png",id:"56f2fb22-2ed7-4d77-b4fa-8fab55c90d93",preselectLabel:"1",preselectId:"6cac5fb7-5416-4749-9ada-0c4920aa01df"},{label:"Doc 1",id:l()},{label:"Doc 2",id:l()}].filter(n=>e?n.label.indexOf(e)>-1:!0))},1e3)}),decorations:[({node:e,append:t,selection:n,view:i})=>{if(e.name==="Signature"){const{state:d,hasFocus:b}=i,p=e&&n.from>=e.from&&n.to<=e.to&&!d.readOnly&&b,a=e.node.cursor();if(a.firstChild()){t(u.line({class:`cm-blockquote${p?" cm-blockquote-indent":""}`}).range(a.from)),t(p?u.mark({class:`cm-blockquote-mark${p?"":" cm-formatting"}`}).range(a.from,a.from+2):u.replace({widget:new class extends I{toDOM(){const m=document.createElement("span");return m.textContent="🖊 Подписанты",m.style.fontSize="1.2rem",m}}}).range(a.from,a.to)),a.nextSibling();do if(a.name==="SignatureLine"){t(u.line({class:`cm-blockquote${p?" cm-blockquote-indent":""}`}).range(a.from)),t(u.mark({class:`cm-blockquote-mark${p?"":" cm-formatting"}`}).range(a.from,a.from+2));const m=a.node.cursor();m.firstChild()&&E({node:m.node,append:t,selection:n,view:i})}while(a.nextSibling())}return!1}}],parsers:[{defineNodes:[{name:"Signature"},{name:"SignatureLine"}],parseBlock:[{name:"Signature",endLeaf(e,t){return t.text.slice(t.pos).trim().startsWith("> ")},parse:(e,t)=>{if(!t.text.startsWith("> [!sign]"))return!1;const n=[];n.push(e.elt("SignatureLine",e.lineStart,e.lineStart+t.text.length));let i=e.peekLine();for(;e.nextLine();){if(!i.startsWith("> ")){e.nextLine();break}const d=i.indexOf("@")>-1?N(e.elt.bind(e),i.indexOf("@")+1,i,e.lineStart):null,b=d?[e.elt("MentionData",d[0].from,d[d.length-1].to,d)]:void 0;n.push(e.elt("SignatureLine",e.lineStart,e.lineStart+i.length,b)),i=e.peekLine()}return e.addElement(e.elt("Signature",n[0]?.from,n[n.length-1].to,n)),!1},before:"Blockquote"}]}]}})})})}};f.parameters={...f.parameters,docs:{...f.parameters?.docs,source:{originalSource:`{
  args: {
    editable: true,
    currentUser: createdByData,
    tools: {},
    blocks: [{
      id: "0",
      type: "text",
      offset: 0,
      hidePrefix: false,
      variants: [{
        id: "11",
        data: {
          text: "Some text is here and link to image ![[ChatGPT Image.png#1|56f2fb22-2ed7-4d77-b4fa-8fab55c90d93#6cac5fb7-5416-4749-9ada-0c4920aa01df|700]] And video ![[test video.mov#1|486503f6-35e9-4865-970f-a211ec242527#0fd10b4d-cebe-4bbd-81da-64d8c1b222a5]] And PDF: ![[app.pdf#1|486503f6-35e9-4865-970f-a211ec242527#0fd10b4d-cebe-4bbd-81da-64d8c1b222a5]]"
        },
        isCurrent: true,
        votes: [],
        createdBy: "user1",
        createdByData: {
          id: "user1",
          avatar: "",
          firstName: "John 1",
          lastName: "",
          middleName: ""
        }
      }]
    }, {
      id: "1",
      type: "text",
      offset: 0,
      hidePrefix: false,
      variants: [{
        id: "11",
        data: {
          text: "> [!sign]\\n> 1. @User 1#Space 1|0:1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef#a41b8b6c-c75f-4ee3-9c19-1d41dc157f96\\n> 2. @User 2#Space 1|-1:1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef#12979c75-d5b9-4759-9060-b7a41dc76ea8"
        },
        isCurrent: true,
        votes: [],
        createdBy: "user1",
        createdByData: {
          id: "user1",
          avatar: "",
          firstName: "John 1",
          lastName: "",
          middleName: ""
        }
      }, {
        id: "12",
        data: {
          text: "Hello, World!"
        },
        isCurrent: false,
        votes: [],
        createdBy: "user2",
        createdByData: {
          id: "user2",
          avatar: "",
          firstName: "Maria",
          lastName: "",
          middleName: ""
        }
      }]
    }, {
      id: "2",
      type: "header",
      offset: 0,
      hidePrefix: false,
      variants: [{
        id: "22",
        data: {
          text: "\`\`\`js \\nconst a = 1;\\n\`\`\`"
        },
        isCurrent: true,
        votes: [],
        createdBy: "user1",
        createdByData: {
          id: "user1",
          avatar: "",
          firstName: "John 1",
          lastName: "",
          middleName: ""
        }
      }]
    }, {
      id: "3",
      type: "text",
      offset: 0,
      hidePrefix: false,
      variants: [{
        id: "22",
        data: {
          text: '[Duck Duck Go](https://duckduckgo.com "The best search engine for privacy") Strange idea! @nice|shot|good@. Really?\\n\\n' + "@nice|123|https://market.b2p.space/api/files/8646013d-5a03-4a9a-a0eb-da774adc0b95@\\n\\n@nice|123|@\\n\\n@nice@ test me\\n\\n" + "[[Правила кооператива_v2_п.2.1|123_345_566]]"
        },
        isCurrent: true,
        votes: [],
        createdBy: "user1",
        createdByData: {
          id: "user1",
          avatar: "",
          firstName: "John 1",
          lastName: "",
          middleName: ""
        }
      }]
    }, {
      id: "4",
      type: "heading",
      offset: 0,
      hidePrefix: false,
      variants: [{
        id: "22",
        data: {
          text: "## Heading 2",
          level: 2
        },
        isCurrent: true,
        votes: [],
        createdBy: "user3",
        createdByData: {
          id: "user3",
          avatar: "",
          firstName: "John",
          lastName: "",
          middleName: ""
        }
      }]
    }, {
      id: "5",
      type: "text",
      offset: 0,
      hidePrefix: false,
      variants: [{
        id: "22",
        data: {
          text: "Monday **10**. ==Nice shot and the **shot** is good!== How are you? Nice ==day"
        },
        isCurrent: true,
        votes: [],
        createdBy: "user1",
        createdByData: {
          id: "user3",
          avatar: "",
          firstName: "John",
          lastName: "",
          middleName: ""
        }
      }]
    }, ...def]
  },
  render: props => {
    const ref = useRef<DataBlockEditorApi>(null);
    const [headEl, setHeadEl] = useState<HTMLElement | null>(null);
    const handleChange = ({
      action,
      data
    }: SendDataBlockEditorUpdates) => {
      setTimeout(() => {
        switch (action) {
          case DataBlockEditorPublicAction.AddBlock:
            ref.current?.updateData({
              action,
              data: {
                index: data.index,
                blocks: data.blocks.map(b => ({
                  ...b,
                  variants: b.variants.map(v => ({
                    ...v,
                    createdByData,
                    votes: []
                  }))
                }))
              }
            });
            break;
          case DataBlockEditorPublicAction.EditBlock:
            ref.current?.updateData({
              action,
              data: {
                block: {
                  ...data.block,
                  variants: data.variant ? [{
                    ...data.variant,
                    createdByData,
                    votes: []
                  }] : []
                },
                variant: {
                  ...data.variant,
                  createdByData,
                  votes: []
                }
              }
            });
            break;
          case DataBlockEditorPublicAction.DeleteBlock:
            ref.current?.updateData({
              action,
              data: {
                blockId: data.blockId
              }
            });
            break;
          case DataBlockEditorPublicAction.MoveBlock:
            ref.current?.updateData({
              action,
              data: {
                blockId: data.blockId,
                targetIndex: data.targetIndex
              }
            });
            break;
          case DataBlockEditorPublicAction.AddVariant:
            ref.current?.updateData({
              action,
              data: {
                blockId: data.blockId,
                variant: {
                  ...data.variant,
                  createdByData,
                  votes: []
                }
              }
            });
            break;
          case DataBlockEditorPublicAction.EditVariant:
            ref.current?.updateData({
              action,
              data: {
                blockId: data.blockId,
                variant: {
                  ...data.variant,
                  createdByData,
                  votes: []
                }
              }
            });
            break;
          case DataBlockEditorPublicAction.DeleteVariant:
            ref.current?.updateData({
              action,
              data: {
                blockId: data.blockId,
                variantId: data.variantId
              }
            });
            break;
        }
      }, 1000);
    };
    return <div style={{
      background: "#f9f9f9",
      margin: "-40px -30px",
      padding: "40px 30px",
      height: 500,
      overflowY: "auto"
    }}>
        <DndProvider backend={HTML5Backend}>
          <DataBlockEditor {...props} ref={ref} onChange={handleChange} tools={{
          text: {
            title: "Text",
            icon: TextIcon,
            shortcut: ["CMD"]
          },
          heading: {
            title: "Header",
            defaultValue: "# ",
            icon: HeadingIcon,
            renderMenu: ({
              variant
            }) => <>
                    <ListItem asButton icon={<HeadingIcon />} onClick={e => setHeadEl(e.currentTarget)} text={<>Header {variant.data.text.split(" ")[0].length}</>} />
                    <Popper open={Boolean(headEl)} anchorEl={headEl}>
                      TODO SELECT HEADER LEVEL
                    </Popper>
                  </>
          },
          sign: {
            title: "Signature",
            icon: HeadingIcon,
            defaultValue: "> [!sign]\\n> 1. ",
            renderMenu: () => <>TODO</>
          }
        }} mdProps={{
          onSearchMentions: async ({
            query = ""
          }) => {
            return new Promise(resolve => {
              setTimeout(() => {
                resolve([{
                  name: \`User 1\`,
                  detailId: uuid(),
                  detailLabel: "Space 1",
                  id: "0:1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef"
                }, {
                  name: \`User 2\`,
                  detailId: uuid(),
                  detailLabel: "Space 1",
                  id: "-1:1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef"
                }].filter(o => !query ? true : o.name.indexOf(query) > -1));
              }, 1000);
            });
          },
          resolveReferenceUrl: ({
            versionId
          }) => versionId ? \`https://localhost:8080/documents/files/\${versionId}\` : "",
          onSearchReference: async ({
            query = ""
          }) => {
            return new Promise(resolve => {
              setTimeout(() => {
                resolve([{
                  label: "ChatGPT Image.png",
                  id: "56f2fb22-2ed7-4d77-b4fa-8fab55c90d93",
                  preselectLabel: "1",
                  preselectId: "6cac5fb7-5416-4749-9ada-0c4920aa01df"
                }, {
                  label: \`Doc 1\`,
                  id: uuid()
                }, {
                  label: \`Doc 2\`,
                  id: uuid()
                }].filter(o => !query ? true : o.label.indexOf(query) > -1));
              }, 1000);
            });
          },
          decorations: [({
            node,
            append,
            selection,
            view
          }) => {
            if (node.name === "Signature") {
              const {
                state,
                hasFocus
              } = view;
              const isActive = node && selection.from >= node.from && selection.to <= node.to && !state.readOnly && hasFocus;
              const cursor = node.node.cursor();
              if (cursor.firstChild()) {
                append(Decoration.line({
                  class: \`cm-blockquote\${isActive ? " cm-blockquote-indent" : ""}\`
                }).range(cursor.from));
                if (!isActive) {
                  append(Decoration.replace({
                    widget: new class extends WidgetType {
                      toDOM() {
                        const span = document.createElement("span");
                        span.textContent = "🖊 Подписанты";
                        span.style.fontSize = "1.2rem";
                        return span;
                      }
                    }()
                  }).range(cursor.from, cursor.to));
                } else {
                  append(Decoration.mark({
                    class: \`cm-blockquote-mark\${!isActive ? " cm-formatting" : ""}\`
                  }).range(cursor.from, cursor.from + 2));
                }
                cursor.nextSibling();
                do {
                  if (cursor.name === "SignatureLine") {
                    append(Decoration.line({
                      class: \`cm-blockquote\${isActive ? " cm-blockquote-indent" : ""}\`
                    }).range(cursor.from));
                    append(Decoration.mark({
                      class: \`cm-blockquote-mark\${!isActive ? " cm-formatting" : ""}\`
                    }).range(cursor.from, cursor.from + 2));
                    const mention = cursor.node.cursor();
                    if (mention.firstChild()) {
                      processMentionDecoration({
                        node: mention.node,
                        append,
                        selection,
                        view
                      });
                    }
                  }

                  // process each immediate child of the CodeBlock node
                } while (cursor.nextSibling());
              }
              return false;
            }
          }],
          parsers: [{
            defineNodes: [{
              name: "Signature"
            }, {
              name: "SignatureLine"
            }],
            parseBlock: [{
              name: "Signature",
              endLeaf(_, line) {
                return line.text.slice(line.pos).trim().startsWith("> ");
              },
              parse: (cx, line) => {
                if (!line.text.startsWith("> [!sign]")) {
                  return false;
                }
                const children: MdElement[] = [];
                children.push(cx.elt("SignatureLine", cx.lineStart, cx.lineStart + line.text.length));
                let nextLine = cx.peekLine();
                while (cx.nextLine()) {
                  if (!nextLine.startsWith("> ")) {
                    cx.nextLine();
                    break;
                  }
                  const userData = nextLine.indexOf("@") > -1 ? parseInlineMention(cx.elt.bind(cx), nextLine.indexOf("@") + 1, nextLine, cx.lineStart) : null;
                  const child = userData ? [cx.elt("MentionData", userData[0].from, userData[userData.length - 1].to, userData)] : undefined;
                  children.push(cx.elt("SignatureLine", cx.lineStart, cx.lineStart + nextLine.length, child));
                  nextLine = cx.peekLine();
                }
                cx.addElement(cx.elt("Signature", children[0]?.from, children[children.length - 1].to, children));
                return false;
              },
              before: "Blockquote"
            }]
          }]
        }} />
        </DndProvider>
      </div>;
  }
}`,...f.parameters?.docs?.source}}};const mn=["Base"];export{f as Base,mn as __namedExportsOrder,ln as default};
